function updateTerraceCleanTitles(startDate, endDate) {
  const cleanCalendar = CalendarApp.getCalendarsByName("clean5 ç¾Žé‡Žå³¶.æ¸…æŽƒä¼šç¤¾(ãƒ©ã‚¤ãƒ•ãƒ–ãƒªãƒƒã‚¸)")[0];
  const reservationCalendar = CalendarApp.getCalendarsByName("5.TABISAI TERRACE ç¾Žé‡Žå³¶")[0];
  if (!cleanCalendar || !reservationCalendar) return;

  const cleanEvents = cleanCalendar.getEvents(startDate, endDate).filter(event =>
    event.isAllDayEvent() && (
      !event.getTitle().trim() || isLateCheckoutTitle(event.getTitle())
    )
  );

  cleanEvents.forEach(cleanEvent => {
    const cleanDate = cleanEvent.getStartTime();
    const reservation = findNextReservation(cleanDate, reservationCalendar);
    if (!reservation) return;

    const title = reservation.getTitle();
    const { guests, nights } = extractGuestInfo(title);
    const towelCount = calculateTowelCount(title, guests, nights);
    const toothbrushCount = nights > 1 ? guests : null;
    const hasCheckin = reservationCalendar.getEventsForDay(cleanDate).length > 0;

    // ðŸ›ï¸ ç¾Žé‡Žå³¶ã®ã‚·ãƒ³ã‚°ãƒ«ãƒ™ãƒƒãƒ‰ãƒ«ãƒ¼ãƒ«
    const singleBeds = guests >= 9 ? 1 : 0;

    const newTitle =
      getLateCheckoutPrefix(cleanEvent.getTitle()) +
      buildCleanEventTitle("ç¾Žé‡Žå³¶", { towelCount, toothbrushCount, hasCheckin, singleBeds });

    cleanEvent.setTitle(newTitle);
  });
}
